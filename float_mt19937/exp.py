from Crypto.Util.number import *

from gf2bv import *
from gf2bv.crypto.mt import *

k = [0.11211220627886054, 0.7618122945141783, 0.32086884297609786, 0.012139939547642142, 0.05732687631202782, 0.5601801296734044, 0.5710775593474308, 0.5767071402190898, 0.641060270327722, 0.8292276727526722, 0.8412151106403272, 0.6302338275629997, 0.11198961056158241, 0.7119504728843618, 0.7931997518748245, 0.6561624702225304, 0.1951456104541226, 0.6860450405229804, 0.41433014713987526, 0.8740322345025173, 0.9108900323451184, 0.12636071040308117, 0.04962656309869373, 0.8415461283473457, 0.6206905212725188, 0.764032161062949, 0.8264867048207251, 0.6325560944070743, 0.1809004334167542, 0.859971795880493, 0.2519944481614894, 0.67275540637382, 0.14307898204258684, 0.9934916760970168, 0.6990169034031457, 0.9087204821288252, 0.5725551857927845, 0.6115054128095131, 0.849441155564254, 0.9387939160312134, 0.6747509088726057, 0.5172591326530812, 0.8965258079484614, 0.814418794153698, 0.9003682699127487, 0.19878043184849992, 0.7973503228619354, 0.7430472005853842, 0.44013922883876244, 0.3900125665736639, 0.41099505803339254, 0.6626624984777599, 0.47561802597247094, 0.4332696258807851, 0.47809973890210744, 0.11716875403517002, 0.315333687307075, 0.22644375954563478, 0.6544562249223412, 0.8145046066567423, 0.8763475992127862, 0.5890058222900239, 0.591429365087817, 0.6861785858651236, 0.5779832960844977, 0.12586820298656654, 0.08548258887386251, 0.15427185190526704, 0.391596879936702, 0.9404162810209393, 0.9014649130867435, 0.6345476103524971, 0.3136659656474222, 0.8980783559871566, 0.3088844711119094, 0.039800688051427224, 0.5494712347834169, 0.8954326561339244, 0.7281383679483024, 0.5820061603168596, 0.9219054262918456, 0.729163585661719, 0.1194655404567363, 0.18837145182022663, 0.8952459664303304, 0.7546480468717439, 0.5131318637029109, 0.9062909753153415, 0.8691769237737983, 0.8496749731534896, 0.4842184435614618, 0.7352200646828901, 0.13967367630875882, 0.4499957987450446, 0.7653006441235212, 0.7285659520392845, 0.10740485691081902, 0.02451352650922478, 0.5959469519461299, 0.580022837622146, 0.6477826917110913, 0.3612494021291267, 0.6640799539356853, 0.15204264131825185, 0.5049394421147175, 0.05429377728395579, 0.6880288894063028, 0.3725334452921246, 0.4737450731939271, 0.32895149401104185, 0.18877120821375903, 0.3120855033733003, 0.7576947345601596, 0.3261812597310493, 0.883722794963401, 0.6870177018921813, 0.04334503723908112, 0.7295052567716255, 0.9083761416803745, 0.12627776222565834, 0.24921396564448284, 0.02532200330565859, 0.9205885045624459, 0.8368716413626522, 0.23643121792939759, 0.4444018788255353, 0.09382892021262512, 0.733442016426186, 0.7693258982487744, 0.08764337255698618, 0.6307792569446682, 0.9317306865555999, 0.684782032018891, 0.7258648716132663, 0.7781504115161871, 0.12079677372014064, 0.40403343716043283, 0.28885248622571147, 0.11884105677912271, 0.9829478904895038, 0.2839001389271114, 0.7242674910186564, 0.7154768908029421, 0.5700903366383906, 0.11324140009295858, 0.5354424611032965, 0.36464902005781663, 0.46909014483616474, 0.03076238907223061, 0.2928656953931743, 0.05730170872084839, 0.10969895936848983, 0.7845586075483205, 0.02277554154801098, 0.5487879743706768, 0.2346063498874802, 0.6598797958868259, 0.8664784785893442, 0.6320045127254243, 0.22568501238520233, 0.7988747780263933, 0.09036438384978862, 0.9303788360154637, 0.9856560082604342, 0.6827660907558444, 0.025693283049661675, 0.25279305574839517, 0.5333246275819326, 0.7697878492749394, 0.6004152146284447, 0.343789323922577, 0.5952973641224395, 0.25767201455179767, 0.6857885707865585, 0.021472215122042004, 0.2940985679711242, 0.6849744323180003, 0.05170928867756386, 0.8904782505064248, 0.3622309534598387, 0.76705771976633, 0.8902224999037571, 0.19462500861986687, 0.800467273789242, 0.6165367941091691, 0.14823638384841376, 0.4522926878545461, 0.00028050254739186986, 0.0024686924820019884, 0.20604127211620915, 0.6161026158374704, 0.11955611091589813, 0.8185234210986984, 0.15962667083581172, 0.222304792880069, 0.9681545747082136, 0.426342346992832, 0.733307304623106, 0.8915654119129507, 0.46937002666986305, 0.4211338831505289, 0.6618210164647809, 0.9460830154433812, 0.28860844426553334, 0.2802951990607646, 0.22982855371066213, 0.9892179986127116, 0.8321094318713218, 0.17269942800158644, 0.04706734499652798, 0.9173406222978878, 0.5246031949807526, 0.923522821862988, 0.41149704188497127, 0.8849045276049781, 0.5848093867762122, 0.7065261167234279, 0.5451501602974245, 0.8203538709804628, 0.9351374282812206, 0.8251187450209175, 0.03714325407549357, 0.7431164608965857, 0.4989884592952256, 0.8719649302710135, 0.15226333705862793, 0.9329450032108341, 0.6967051163404943, 0.31333560077040834, 0.9847523360519966, 0.45088789231192905, 0.07658653676675153, 0.10551214091416927, 0.841183936569375, 0.8998128248798496, 0.5047528670661572, 0.20497276942604148, 0.8114714742761985, 0.13366170641290887, 0.4024856200975785, 0.8767541626945409, 0.9602289754692642, 0.6073015720613719, 0.17182930623399262, 0.3078316619351714, 0.16006257734647011, 0.9761053131618551, 0.6475332945767703, 0.3507970635492669, 0.23520445908746745, 0.5047363080654647, 0.8568493883873352, 0.2730066299188102, 0.025645796018370914, 0.25747466724579227, 0.45387975107862233, 0.8012241951471553, 0.4823174334004189, 0.07319262796905313, 0.8975785111103525, 0.35973783370866863, 0.3670829661146545, 0.1607975069673635, 0.10809443974041877, 0.9675537246143604, 0.6997946894247212, 0.36774158010268176, 0.16596872358604686, 0.32678233559550596, 0.8160120089283107, 0.30298174823971813, 0.5318838458306484, 0.6293984620507754, 0.06165497467698411, 0.10500208448955073, 0.5451500018922003, 0.7740928270855515, 0.5174708666688568, 0.8508588311574009, 0.7603702528897415, 0.8488595239599602, 0.4850046789412351, 0.041727599477393795, 0.49819303837598106, 0.39360847349083294, 0.6084959962367718, 0.5690559288378217, 0.8426621499066411, 0.6842437288468796, 0.9894110440836464, 0.7037927331411843, 0.3229619490468254, 0.9370696069850325, 0.916685290729451, 0.9495999195117747, 0.8750472093294531, 0.3085354347018614, 0.01710903368889971, 0.9327225134274088, 0.27773313442283776, 0.4171189228732074, 0.7557327453274222, 0.18747985113444554, 0.9247320324446741, 0.7767677386195418, 0.7702286589557962, 0.9651638712779861, 0.6674147183467576, 0.8783955112789841, 0.7690120462383124, 0.07009639148993363, 0.7192453073754921, 0.9486153771293658, 0.05443132890093183, 0.27671567557185983, 0.9343259480209779, 0.6076448993587489, 0.4298689315214519, 0.11387031762313393, 0.15645677102810285, 0.4741186672922334, 0.3411482276758223, 0.09789113093305823, 0.1883766059948493, 0.3248484968707145, 0.2928307084781667, 0.38040768628185184, 0.1617619665699519, 0.7193699332148493, 0.7356214345376427, 0.4830217096118351, 0.3545133249479313, 0.48562541593815967, 0.5631738931873561, 0.6285254162906082, 0.4970138317002528, 0.9198071369466192, 0.9280801290549596, 0.13662123744198362, 0.5170136909427941, 0.768632971571653, 0.6252176531738869, 0.1297714827621932, 0.46512424228369487, 0.5814974685370035, 0.37235494455089313, 0.29993747570646456, 0.21380701043578232, 0.6742175729899822, 0.6648544829458994, 0.24851652581082617, 0.4423677923872965, 0.9517130244260784, 0.6382511865670334, 0.03717452170556923, 0.9486501934731861, 0.02800329296454518, 0.3456618610914627, 0.4875807925580914, 0.020874595464904555, 0.3012524241255743, 0.27920000342433726, 0.857622909287446, 0.8473848427971157, 0.22694097553023518, 0.7282655695645042, 0.32688014728104753, 0.7937066520635674, 0.9673163498856522, 0.26991044804063113, 0.5109751875155277, 0.5597619194995906, 0.5129684340277978, 0.880256670112151, 0.1208737915820659, 0.14237270688743842, 0.24625224757229902, 0.14684491078155093, 0.4018131783081985, 0.256865754193491, 0.3273875883061089, 0.32343464996210336, 0.755735896181482, 0.36082669066723305, 0.8351701089899223, 0.0361753883363628, 0.9671491036285383, 0.46554568626202597, 0.12778339724258836, 0.7383411688284128, 0.6778360714986328, 0.4679206956764925, 0.5766875855546646, 0.5060282864984209, 0.2868163085826393, 0.05722493050976807, 0.4719804435637228, 0.6309254866106604, 0.28455498091151565, 0.1211906448066854, 0.1489724406149353, 0.3295907976001845, 0.7742183288060376, 0.9957204314642332, 0.6157015225772743, 0.08797207088563286, 0.7662887482975632, 0.5313390149216846, 0.9338434928604069, 0.6798259465706731, 0.4942000984758609, 0.18994102225144383, 0.6166623297406328, 0.1806093284062409, 0.5858750929970882, 0.7869049071210406, 0.4718941835197372, 0.23495408119690286, 0.02474793475878645, 0.4772752641508585, 0.07201375352769035, 0.41754064280275094, 0.33673960053516494, 0.4201056887269531, 0.4486733533627274, 0.19530076962219722, 0.5189437369676511, 0.7655168209760168, 0.5528636706094358, 0.5124672975183318, 0.6543837651366478, 0.43421159950403854, 0.9938108112631697, 0.8533734673574084, 0.07323816040200881, 0.5536407104157456, 0.0051751318477184505, 0.32395048314956854, 0.875888713689039, 0.11255757406976641, 0.8588310896714225, 0.37703628432862923, 0.5644400588570279, 0.6424457668281456, 0.08954225820605544, 0.5964087736179581, 0.8260418962586753, 0.3637168280846408, 0.1444310314155438, 0.004290363385861307, 0.36844178479635137, 0.10103423668591549, 0.29509081359207123, 0.5549124254726808, 0.015848426587263154, 0.6721986376294371, 0.698043345699434, 0.6192276598900391, 0.354994696620082, 0.7840143777455716, 0.21182378924685807, 0.2978052975432882, 0.14395596892808893, 0.23448803609423507, 0.09298388995295359, 0.778543839916861, 0.45491921902069354, 0.6620025030176491, 0.22112992776830132, 0.6959463619959626, 0.8448723293943706, 0.06595349203851453, 0.8527042535671044, 0.5018195399130879, 0.1068727924364754, 0.25567691995789654, 0.4373144470476794, 0.046353987025205434, 0.07116575059213459, 0.25432734477658503, 0.4578983717187386, 0.43935740612982643, 0.3639837409922002, 0.42405461000479117, 0.15051332038729515, 0.04906721750246634, 0.6684837839011128, 0.026094453080733104, 0.4678643393255921, 0.4426937692967666, 0.4652005507738852, 0.1051959821581041, 0.11437304749078847, 0.9302897791566653, 0.8883805878917284, 0.9652075820383791, 0.24451569544786944, 0.16155540776764, 0.9046858506426446, 0.21213788256245525, 0.6748039138131218, 0.11453310766054814, 0.9321764567535219, 0.39307148637452105, 0.2896661015305986, 0.37095571829694973, 0.03375197790262707, 0.40823511735569706, 0.44174634922180467, 0.978294499086653, 0.9400191128264855, 0.686452795347334, 0.47074371473465604, 0.4411477203988491, 0.004776091105891167, 0.09192406542942055, 0.796195052127473, 0.08859090780736578, 0.9018915532567413, 0.5233554912643551, 0.23582562035100396, 0.3146228286642866, 0.8847096842816862, 0.42651927785445454, 0.4141177615952296, 0.8645384386163699, 0.6514565560470075, 0.8778482263633529, 0.9394794476989712, 0.04598312075638744, 0.49276559028058275, 0.9600949997564825, 0.8177704442853598, 0.3381280099632936, 0.8497877698371004, 0.7667346108038378, 0.4917709376244328, 0.6484083462487162, 0.18528798741017838, 0.3567410454987041, 0.45683213659438393, 0.33151125855312014, 0.41744930093048904, 0.35439454488941824, 0.3037063770224053, 0.5647046032367844, 0.9086518157502865, 0.5830248143424184, 0.9197788190571647, 0.8066383722351291, 0.8509263977211654, 0.5890765557870751, 0.10353944681117688, 0.5894078324615912, 0.81278163322285, 0.26182473361968994, 0.29378455126864167, 0.45780966275565227, 0.2650376853666474, 0.09125751227084966, 0.6126165683553819, 0.8388506508197572, 0.0788746542389741, 0.7550215948299461, 0.39427911305428465, 0.8181848813696022, 0.12208922295318259, 0.8829065221304018, 0.305923835801855, 0.15550170516807826, 0.204433769005963, 0.22434218471890943, 0.24062506546963902, 0.6349438224737911, 0.38706688476411055, 0.02010168389535405, 0.024738851403148132, 0.33139679665580135, 0.8660821591466493, 0.6382421182755958, 0.0668653931321147, 0.8622196146852295, 0.37539025207837085, 0.5913986034565655, 0.18403931040423205, 0.23113350271665256, 0.018559000364688383, 0.5361840496906243, 0.9134027068385843, 0.98210774368613, 0.5939584749341374, 0.03027299459971977, 0.5651260839673945, 0.6429370608846596, 0.060101125829733704, 0.40779022382520946, 0.12455780154070739, 0.7115450864721332, 0.255473580362779, 0.7449864416367771, 0.6755931409849955, 0.6373119915178139, 0.6250941160045281, 0.7965450142922598, 0.937841979552364, 0.14303074617602485, 0.9087270288187208, 0.7629495756224206, 0.02811623241743011, 0.6255707861689496, 0.45092265438816437, 0.9137686178611807, 0.375342274132316, 0.058293751672589655, 0.7879776549826081, 0.20482207322238477, 0.16465915920569252, 0.30754940735852176, 0.018414397445679187, 0.2942802997977335, 0.9199411717155705, 0.48501458394608443, 0.30583594222241384, 0.20859902358616855, 0.8393685772920721, 0.15660105839951144, 0.3565465541875842, 0.9115983633096396, 0.024611630984010313, 0.1803071196648427, 0.7393166803822828, 0.731200944450378, 0.15283772111559546, 0.05511026502590255, 0.9838676971432877, 0.9168476848749956, 0.857389279961455, 0.3623642947584437, 0.19144719628804496, 0.7900698732493526, 0.8674031049901657, 0.9552359397653887, 0.577184918078724, 0.4675222514120728, 0.4115253331184304, 0.506341458948112, 0.2538927928364715, 0.44938839474568537, 0.7802147065894603, 0.04558881623355182, 0.7575518121306974, 0.4566668837024518, 0.14284092825811034, 0.37081416972335224, 0.6111191396730593, 0.11352783114878529, 0.918838884646096, 0.17972181495211992, 0.1731543797629994, 0.18790671726430874, 0.718324153432767, 0.010208824307359365, 0.9332658761397301, 0.8080103195473053, 0.9379936764262823, 0.6169792499850159, 0.5380533072417989, 0.2814261879959592, 0.7379387886105792, 0.1361009904448749, 0.733373580295409, 0.11243544177142484, 0.1594690620362249, 0.6972809717857661, 0.3812039457036356, 0.3990235214300851, 0.9576402663022862, 0.6506529537502442, 0.9561607276377893, 0.19721145536382345, 0.7798802500048285, 0.5819371029529101, 0.1910634928136944, 0.0861249124418354, 0.09530008896112518, 0.8948401856934348, 0.5450692272756945, 0.1526815165327836, 0.16325161299597057, 0.33529302353504087, 0.6559464897105078, 0.8443003950915998, 0.7258096679118506, 0.3151714450678007, 0.4253449188556563, 0.899078675728288, 0.18039302217170272, 0.7315615710294027, 0.1939048903259536, 0.7291849554131637]
ct = 12481343236288582915197210951380294970221748522297578384190663761938472748380765264776726249324740698918977653791447565730359233142876791192705444992674211

linear_system = LinearSystem([32] * 624)
mt = MT19937(linear_system.gens())

zeros = []

for i in k:
    r = int(i * 9007199254740992)
    a = r // 67108864
    b = r % 67108864
    zeros.append((mt.getrandbits(32) >> 5) ^ a)
    zeros.append((mt.getrandbits(32) >> 6) ^ b)

sol = linear_system.solve_one(zeros)
mt = MT19937(sol).to_python_random()

for i in k:
    mt.getrandbits(32)
    mt.getrandbits(32)

print(long_to_bytes(ct ^ mt.getrandbits(512)))