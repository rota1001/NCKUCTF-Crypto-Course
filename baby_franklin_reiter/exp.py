from Crypto.Util.number import *
from sage.all import *

e = 37
n = 7135177822517373848903342570304910324225667475353468192462083754666937122170263639787755155262188293787441469945694922069593761090740847456042381914098373
c1 = 344411187960509559135586427256505967053366251302292479890437922784811150911449906964337353253059220956760188709021694404668518814729053089378448722558807
c2 = 6804920373021335051738091118953532555818691250338145681524438306494275417720139745870475492821217371171998197339101466030904828573682431671032972812661004
def gcd(g1, g2):
    while g2:
        g1, g2 = g2, g1 % g2
    return g1.monic()

def related_message_attack(c1: int, c2: int, n: int, e: int, f: function) -> int:
    P = PolynomialRing(Zmod(n), "x")
    x = P.gens()[0]
    f1 = x ** e - c1
    f2 = f(x) ** e - c2
    return int(-gcd(f1, f2)[0])

m = related_message_attack(c1, c2, n, e, lambda x: 12345 * x + 54321)

print(long_to_bytes(m))
